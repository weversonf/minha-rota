<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#121212">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Minha Rota v24 - Premium Navigation</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/tangram/dist/tangram.min.js"></script>

    <style>
        :root { 
            --cor-principal: #FF4757; 
            --cor-fundo: #0F0F0F; 
            --cor-card: rgba(25, 25, 25, 0.9);
            --radius: 20px;
            --shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.5);
        }

        body { 
            margin: 0; padding: 0; 
            background: var(--cor-fundo); 
            font-family: 'Inter', -apple-system, sans-serif; 
            overflow: hidden; 
            color: #FFFFFF;
        }

        /* LOGIN */
        #login-screen { 
            position: fixed; width: 100%; height: 100%; 
            background: radial-gradient(circle at center, #1e1e1e 0%, #0f0f0f 100%);
            z-index: 5000; display: flex; align-items: center; justify-content: center; 
            transition: 0.5s;
        }
        .login-card {
            background: var(--cor-card); backdrop-filter: blur(15px);
            padding: 40px; border-radius: var(--radius); text-align: center; width: 80%; max-width: 320px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        /* HEADER */
        #header-app { 
            position: fixed; top: 0; left: 0; width: 100%; height: 70px; 
            background: rgba(15, 15, 15, 0.85); backdrop-filter: blur(15px);
            z-index: 1000; display: none; align-items: center; justify-content: space-between; 
            padding: 0 20px; box-sizing: border-box; 
        }
        #header-app h1 { font-size: 14px; letter-spacing: 2px; text-transform: uppercase; font-weight: 700; color: #fff; }

        /* INPUTS MODERNOS */
        input, select {
            width: 100%; padding: 16px; margin-bottom: 12px; 
            background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 14px; color: white; box-sizing: border-box; outline: none;
        }
        input:focus { border-color: var(--cor-principal); }

        /* BUSCA DUPLA (ORIGEM/DESTINO) */
        #nav-header { 
            position: fixed; top: 80px; left: 15px; right: 15px; 
            z-index: 500; display: none; 
        }
        .search-container { 
            background: var(--cor-card); backdrop-filter: blur(15px);
            border-radius: var(--radius); padding: 15px; box-shadow: var(--shadow);
            border: 1px solid rgba(255,255,255,0.1);
        }
        .search-input { margin-bottom: 8px; font-size: 14px; }

        /* MAPA */
        #map { position: absolute; top: 0; bottom: 0; width: 100%; z-index: 1; display: none; }

        /* SIDEBAR DRAWER */
        #sidebar { 
            position: fixed; top: 0; left: -100%; width: 85%; max-width: 300px; 
            height: 100%; background: #121212; z-index: 2000; 
            transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
            padding: 100px 25px 25px; box-sizing: border-box; 
        }
        #sidebar.active { left: 0; }

        /* PAINEL DE RESULTADOS (RODAP√â) */
        #route-info {
            position: fixed; bottom: -100%; left: 15px; right: 15px;
            background: var(--cor-card); backdrop-filter: blur(15px);
            border-radius: var(--radius); padding: 20px; z-index: 500;
            transition: 0.5s; border: 1px solid rgba(255,255,255,0.1);
            display: flex; justify-content: space-around; text-align: center;
        }
        .route-stat { font-weight: 800; font-size: 18px; color: #2ed573; }
        .route-label { font-size: 10px; color: #888; text-transform: uppercase; }

        .btn-acao { 
            padding: 18px; border-radius: 14px; border: none; font-weight: 700; 
            cursor: pointer; transition: 0.2s; text-transform: uppercase;
        }
        .btn-principal { background: var(--cor-principal); color: white; width: 100%; }
        .btn-icon { background: rgba(255,255,255,0.1); border-radius: 50%; width: 45px; height: 45px; color: white; border: none; font-size: 20px; cursor: pointer; }
        
        .suggestions { background: rgba(20, 20, 20, 0.95); border-radius: 12px; display: none; max-height: 150px; overflow-y: auto; margin-bottom: 10px; }
        .suggestion-item { padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05); font-size: 13px; }
    </style>
</head>
<body>

<div id="login-screen">
    <div class="login-card">
        <div style="font-size: 40px; margin-bottom: 10px;">üèçÔ∏è</div>
        <h2 style="margin: 0 0 20px 0; font-weight: 800; letter-spacing: 2px;">v24 PREMIUM</h2>
        <input type="password" id="pass" placeholder="Senha do Grupo">
        <button onclick="App.entrar()" class="btn-acao btn-principal">ACESSAR</button>
    </div>
</div>

<header id="header-app">
    <button class="btn-icon" id="menu-btn" onclick="App.toggleMenu()">‚ò∞</button>
    <h1>Minha Rota v24</h1>
    <button class="btn-icon" onclick="App.sos()" style="background: rgba(255, 71, 87, 0.2); color: var(--cor-principal);">üÜò</button>
</header>

<div id="sidebar">
    <h2 style="color: var(--cor-principal); margin-bottom: 30px;">Ve√≠culo</h2>
    <label style="color:#666; font-size:10px; font-weight:700;">MONTADORA</label>
    <select id="sel-montadora" onchange="App.atualizarModelos()">
        <option value="">Selecione...</option>
        <option value="yamaha">Yamaha</option>
        <option value="honda">Honda</option>
    </select>
    
    <label style="color:#666; font-size:10px; font-weight:700;">MODELO</label>
    <select id="sel-modelo" onchange="App.aplicarConsumo()">
        <option value="">--</option>
    </select>

    <label style="color:#666; font-size:10px; font-weight:700;">CONSUMO (km/L)</label>
    <input type="number" id="consumo" value="29">
    
    <button class="btn-acao btn-principal" style="background: #2ed573; margin-top: 20px;" onclick="App.toggleMenu()">SALVAR</button>
</div>

<div id="nav-header">
    <div class="search-container">
        <input type="text" id="input-origem" class="search-input" placeholder="Origem: Minha Localiza√ß√£o" oninput="App.buscar(this.value, 'origem')">
        <div id="sug-origem" class="suggestions"></div>
        
        <input type="text" id="input-destino" class="search-input" placeholder="Destino: Para onde?" oninput="App.buscar(this.value, 'destino')">
        <div id="sug-destino" class="suggestions"></div>
        
        <button class="btn-acao btn-principal" style="padding: 12px; font-size: 12px;" onclick="App.calcularRota()">TRA√áAR ROTA</button>
    </div>
</div>

<div id="route-info">
    <div><span id="res-dist" class="route-stat">0</span><br><span class="route-label">Dist√¢ncia (km)</span></div>
    <div><span id="res-custo" class="route-stat">0</span><br><span class="route-label">Custo Est. (R$)</span></div>
    <div><button class="btn-acao" style="background: #3498db; color: white; padding: 10px 20px; border-radius: 12px;" onclick="location.reload()">NOVA</button></div>
</div>

<div id="map"></div>

<script>
    const VEICULOS = {
        yamaha: { "Fazer 250 (FZ25)": 29, "MT-03": 22, "Lander 250": 30 },
        honda: { "CB 300F": 32, "XRE 300": 26, "CG 160": 41 }
    };

    const App = {
        map: null,
        userLoc: [-3.7319, -38.5267],
        coords: { origem: null, destino: null },
        routeLayer: null,

        entrar() {
            if(document.getElementById('pass').value === 'FZ25-FOR') {
                document.getElementById('login-screen').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('login-screen').style.display = 'none';
                    document.getElementById('header-app').style.display = 'flex';
                    document.getElementById('nav-header').style.display = 'block';
                    document.getElementById('map').style.display = 'block';
                    this.initMapa();
                }, 400);
            }
        },

        initMapa() {
            this.map = L.map('map', { zoomControl: false }).setView(this.userLoc, 15);
            Tangram.leafletLayer({ scene: 'https://www.nextzen.org/carto/cinnabar-style/cinnabar-style.yaml' }).addTo(this.map);
            
            navigator.geolocation.getCurrentPosition(p => {
                this.userLoc = [p.coords.latitude, p.coords.longitude];
                this.coords.origem = this.userLoc;
                this.map.setView(this.userLoc, 16);
                L.circleMarker(this.userLoc, { radius: 7, color: '#fff', weight: 2, fillColor: '#FF4757', fillOpacity: 1 }).addTo(this.map);
            });
        },

        atualizarModelos() {
            const m = document.getElementById('sel-montadora').value;
            const s = document.getElementById('sel-modelo');
            s.innerHTML = '<option value="">Escolha...</option>';
            if(m) Object.keys(VEICULOS[m]).forEach(mod => s.innerHTML += `<option value="${VEICULOS[m][mod]}">${mod}</option>`);
        },

        aplicarConsumo() { document.getElementById('consumo').value = document.getElementById('sel-modelo').value; },

        toggleMenu() { 
            const s = document.getElementById('sidebar');
            const b = document.getElementById('menu-btn');
            s.classList.toggle('active');
            b.innerText = s.classList.contains('active') ? '‚úï' : '‚ò∞';
        },

        async buscar(query, tipo) {
            if (query.length < 3) return;
            const res = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${query}, Fortaleza&limit=4`);
            const data = await res.json();
            const container = document.getElementById('sug-' + tipo);
            container.innerHTML = '';
            container.style.display = data.length ? 'block' : 'none';
            
            data.forEach(item => {
                const div = document.createElement('div');
                div.className = 'suggestion-item';
                div.innerText = item.display_name.split(',')[0];
                div.onclick = () => {
                    this.coords[tipo] = [parseFloat(item.lat), parseFloat(item.lon)];
                    document.getElementById('input-' + tipo).value = item.display_name.split(',')[0];
                    container.style.display = 'none';
                };
                container.appendChild(div);
            });
        },

        async calcularRota() {
            if(!this.coords.origem || !this.coords.destino) return alert("Defina origem e destino!");
            
            const url = `https://router.project-osrm.org/route/v1/driving/${this.coords.origem[1]},${this.coords.origem[0]};${this.coords.destino[1]},${this.coords.destino[0]}?overview=full&geometries=geojson`;
            const res = await fetch(url);
            const data = await res.json();
            
            if(data.routes && data.routes[0]) {
                const route = data.routes[0];
                if(this.routeLayer) this.map.removeLayer(this.routeLayer);
                
                this.routeLayer = L.geoJSON(route.geometry, { style: { color: '#FF4757', weight: 6, opacity: 0.8 } }).addTo(this.map);
                this.map.fitBounds(this.routeLayer.getBounds(), { padding: [50, 50] });

                const dist = (route.distance / 1000).toFixed(1);
                const custo = (dist / document.getElementById('consumo').value * 6.15).toFixed(2);

                document.getElementById('res-dist').innerText = dist;
                document.getElementById('res-custo').innerText = custo;
                document.getElementById('route-info').style.bottom = '20px';
                document.getElementById('nav-header').style.display = 'none';
            }
        },

        sos() { window.open(`https://wa.me/?text=Emerg√™ncia! Localiza√ß√£o: http://maps.google.com/maps?q=${this.userLoc[0]},${this.userLoc[1]}`); }
    };
</script>
</body>
</html>
