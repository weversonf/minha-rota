<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#121212">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Minha Rota v23 - Premium UI</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/tangram/dist/tangram.min.js"></script>

    <style>
        :root { 
            --cor-principal: #FF4757; 
            --cor-fundo: #0F0F0F; 
            --cor-card: rgba(30, 30, 30, 0.85);
            --radius: 18px;
            --shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        body { 
            margin: 0; padding: 0; 
            background: var(--cor-fundo); 
            font-family: 'Inter', -apple-system, sans-serif; 
            overflow: hidden; 
            color: #FFFFFF;
        }

        /* LOGIN MODERNO */
        #login-screen { 
            position: fixed; width: 100%; height: 100%; 
            background: radial-gradient(circle at center, #1e1e1e 0%, #0f0f0f 100%);
            z-index: 5000; display: flex; align-items: center; justify-content: center; 
        }
        .login-card {
            background: var(--cor-card);
            backdrop-filter: blur(10px);
            padding: 40px; border-radius: var(--radius);
            box-shadow: var(--shadow);
            text-align: center; width: 80%; max-width: 320px;
        }

        /* HEADER PREMIUM */
        #header-app { 
            position: fixed; top: 0; left: 0; width: 100%; height: 70px; 
            background: rgba(15, 15, 15, 0.8); backdrop-filter: blur(12px);
            z-index: 1000; display: none; align-items: center; justify-content: space-between; 
            padding: 0 20px; box-sizing: border-box; 
        }
        #header-app h1 { font-size: 14px; letter-spacing: 2px; text-transform: uppercase; font-weight: 700; color: #fff; }

        /* INPUTS FLAT DESIGN */
        input[type="password"], input[type="number"], input[type="text"], select {
            width: 100%; padding: 16px; margin-bottom: 15px; 
            background: rgba(255, 255, 255, 0.05); 
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px; color: white; box-sizing: border-box;
            transition: 0.3s;
        }
        input:focus { border-color: var(--cor-principal); outline: none; background: rgba(255, 255, 255, 0.1); }

        /* BUSCA FLOATING CARD */
        #nav-header { 
            position: fixed; top: 85px; left: 15px; right: 15px; 
            z-index: 500; display: none; 
        }
        .search-container { 
            background: var(--cor-card); backdrop-filter: blur(10px);
            border-radius: var(--radius); box-shadow: var(--shadow);
            border: 1px solid rgba(255,255,255,0.1); overflow: hidden; 
        }
        .search-input { width: 100%; background: transparent; border: none; padding: 18px; color: white; font-size: 16px; outline: none; }

        /* MAPA FULLSCREEN */
        #map { position: absolute; top: 0; bottom: 0; width: 100%; z-index: 1; display: none; }

        /* SIDEBAR ESTILO DRAWER */
        #sidebar { 
            position: fixed; top: 0; left: -100%; width: 85%; max-width: 300px; 
            height: 100%; background: #121212; z-index: 2000; 
            transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
            padding: 100px 25px 25px; box-sizing: border-box; 
            box-shadow: 20px 0 50px rgba(0,0,0,0.5);
        }
        #sidebar.active { left: 0; }

        /* BOT√ïES FLAT */
        .btn-acao { 
            padding: 18px; border-radius: 14px; border: none; 
            font-weight: 700; font-size: 14px; cursor: pointer; 
            transition: 0.2s; text-transform: uppercase; letter-spacing: 1px;
        }
        .btn-acao:active { transform: scale(0.96); }
        .btn-principal { background: var(--cor-principal); color: white; width: 100%; }
        .btn-icon { background: rgba(255,255,255,0.1); border-radius: 50%; width: 45px; height: 45px; color: white; display: flex; align-items: center; justify-content: center; font-size: 20px; border: none; }

        .suggestions { background: var(--cor-card); border-top: 1px solid rgba(255,255,255,0.1); display: none; max-height: 200px; overflow-y: auto; }
        .suggestion-item { padding: 16px; color: #ddd; border-bottom: 1px solid rgba(255,255,255,0.05); font-size: 14px; }
    </style>
</head>
<body>

<div id="login-screen">
    <div class="login-card">
        <div style="font-size: 40px; margin-bottom: 10px;">üèçÔ∏è</div>
        <h2 style="margin: 0 0 20px 0; font-weight: 800; font-size: 22px;">MINHA ROTA</h2>
        <input type="password" id="pass" placeholder="Senha FZ25">
        <button onclick="App.entrar()" class="btn-acao btn-principal">ENTRAR</button>
        <button id="btn-install" class="btn-acao" style="background: none; color: #888; margin-top: 10px; display: none;">Instalar App</button>
    </div>
</div>

<header id="header-app">
    <button class="btn-icon" onclick="App.toggleMenu()">‚ò∞</button>
    <h1>Minha Rota v23</h1>
    <button class="btn-icon" onclick="App.sos()" style="background: rgba(255, 71, 87, 0.2); color: var(--cor-principal);">üÜò</button>
</header>

<div id="sidebar">
    <h2 style="margin-top: 0; color: var(--cor-principal);">Ajustes</h2>
    <div style="margin-bottom: 25px;">
        <label style="color:#666; font-size:11px; font-weight: 700;">CONSUMO FZ25 (km/L)</label>
        <input type="number" id="consumo" value="29">
    </div>
    <button class="btn-acao btn-principal" style="background: #2ed573;" onclick="App.toggleMenu()">CONCLU√çDO</button>
</div>

<div id="nav-header">
    <div class="search-container">
        <input type="text" class="search-input" placeholder="Para onde vamos hoje?" oninput="App.buscar(this.value)">
        <div id="suggestions" class="suggestions"></div>
    </div>
</div>

<div id="map"></div>

<script>
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => { e.preventDefault(); deferredPrompt = e; document.getElementById('btn-install').style.display = 'block'; });
    
    const App = {
        map: null,
        userLoc: [-3.7319, -38.5267],

        entrar() {
            if(document.getElementById('pass').value === 'FZ25-FOR') {
                document.getElementById('login-screen').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('login-screen').style.display = 'none';
                    document.getElementById('header-app').style.display = 'flex';
                    document.getElementById('nav-header').style.display = 'block';
                    document.getElementById('map').style.display = 'block';
                    this.initMapa();
                }, 300);
            }
        },

        initMapa() {
            this.map = L.map('map', { zoomControl: false }).setView(this.userLoc, 16);
            Tangram.leafletLayer({
                scene: 'https://www.nextzen.org/carto/cinnabar-style/cinnabar-style.yaml',
                attribution: 'Nextzen, OSM'
            }).addTo(this.map);

            navigator.geolocation.getCurrentPosition(p => {
                const pos = [p.coords.latitude, p.coords.longitude];
                this.map.setView(pos, 16);
                L.circleMarker(pos, { radius: 8, color: '#fff', weight: 3, fillColor: '#3498db', fillOpacity: 1 }).addTo(this.map);
            });
        },

        async buscar(query) {
            if (query.length < 3) return;
            const res = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${query}, Fortaleza&limit=5`);
            const data = await res.json();
            const container = document.getElementById('suggestions');
            container.innerHTML = '';
            container.style.display = data.length ? 'block' : 'none';
            
            data.forEach(item => {
                const div = document.createElement('div');
                div.className = 'suggestion-item';
                div.innerText = item.display_name.split(',')[0] + ', ' + item.display_name.split(',')[1];
                div.onclick = () => {
                    const coords = [parseFloat(item.lat), parseFloat(item.lon)];
                    this.map.flyTo(coords, 17, { duration: 1.5 });
                    container.style.display = 'none';
                };
                container.appendChild(div);
            });
        },

        toggleMenu() { document.getElementById('sidebar').classList.toggle('active'); },
        sos() { window.open(`https://wa.me/?text=Emerg√™ncia FZ25! Localiza√ß√£o: https://www.google.com/maps?q=${this.userLoc[0]},${this.userLoc[1]}`); }
    };
</script>

</body>
</html>
